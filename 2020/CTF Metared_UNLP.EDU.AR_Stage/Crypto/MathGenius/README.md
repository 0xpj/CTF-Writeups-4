# MathGenius (250)
> nc mathgenius.ctf.cert.unlp.edu.ar 5002 <br>
> Author: @puck <br>
> [:arrow_down: mathgenius.txt](mathgenius.txt)

## Solution
Connecting with `netcat` we get,
```console
root@kali:~/Downloads/certunlp2020/crypto/mathgenius# nc mathgenius.ctf.cert.unlp.edu.ar 5002 
    ____      __
   /  _/___  / /__________
   / // __ \/ __/ ___/ __ \
 _/ // / / / /_/ /  / /_/ /
/___/_/ /_/\__/_/   \____/

   _______ __                                         _     __          __
  / ____(_) /_  ___  _____________  ____ ___  _______(_)___/ /___ _____/ /
 / /   / / __ \/ _ \/ ___/ ___/ _ \/ __ `/ / / / ___/ / __  / __ `/ __  /
/ /___/ / /_/ /  __/ /  (__  )  __/ /_/ / /_/ / /  / / /_/ / /_/ / /_/ /
\____/_/_.___/\___/_/  /____/\___/\__, /\__,_/_/  /_/\__,_/\__,_/\__,_/
                                 /____/                                   
[524647281525540,441563402403648,382466610064889,345922456306122,68513820387294,17954893833470,233082315532800,196214835018195,556930230240510,374417258929298,69700962166640,347797596873060,254961519964908,231848543358936,224437162794393,39083295591230,210683046094028,169207421263494,8907108740085,491415491974485,234047928784376,347096174949450,182852354730490,508093519602592,564516168713034,155243305897344,573924230324144,168544786580058,119162772633268,213659572905085,457339925612097,391673600934648,61076007315365,399911675360400,464272452973016,204974084888496,33487968473322,172393230634878,541285194552250,39754676716430]

Mandaste fruta! nos vimo
```
### Source Script [mathgenius.txt](mathgenius.txt):
```py
def challenge():
    flag = open("flag.txt").read()
    arr = []
    for char in flag:
        r= random.randint(4, 5345346346435)
        r = r - 17+17+17
        arr.append(str(r * ord(char)))

    send_to_client("[{}]\n".format(",".join(arr)).encode())
```
Got something really interesting here: [https://medium.com/@cxzero/owasp-latam-at-home-ctf-2020-write-up-81485800afcc](https://medium.com/@cxzero/owasp-latam-at-home-ctf-2020-write-up-81485800afcc)
### Solve Script: [apex.py](apex.py)
```py
import sympy
from pwn import *

""" ref
https://medium.com/@cxzero/owasp-latam-at-home-ctf-2020-write-up-81485800afcc
"""

def con():
	# nc mathgenius.ctf.cert.unlp.edu.ar 5002
	r = remote("mathgenius.ctf.cert.unlp.edu.ar", 5002)
	try:		
		# scrape nums
		r.recvuntil('[')
		tmp = r.recv().strip()[:-1]
		data = tmp.split(b',')
		nums = []
		for n in data:
			nums.append(int(n.decode()))
		return nums
	except:
		r.interactive()


ri = list()
for i in range(10):	
	print(f"[*] Collecting Sample No. [ {i} ] ", end='')	
	nums = con()
	ri.append(nums)

print(f"\n[*] Collected Samples:")
with open('nums.txt','w') as f:
	for i in ri:
		f.write(str(i) + '\n')
		print(i)

# Attack
print(f"\n[*] Attacking Rands...")
res=''
for s in range(0,40):
	res +=	chr ( sympy.igcd(ri[0][s] , ri[1][s] , ri[2][s], ri[3][s], ri[4][s], ri[5][s], ri[6][s], ri[7][s], ri[8][s], ri[9][s]) )
print (res)
```
### Output:
```console
root@kali:~/Downloads/certunlp2020/crypto/mathgenius# python3 apex.py 
[*] Collecting Sample No. [ 0 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 1 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 2 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 3 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 4 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 5 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 6 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 7 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 8 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done
[*] Collecting Sample No. [ 9 ] [+] Opening connection to mathgenius.ctf.cert.unlp.edu.ar on port 5002: Done

[*] Collected Samples:
[249269382034656, 370304830000548, 136412224375015, 41485301553588, 243999353711214, 221416914484040, 159647347897104, 315211241997510, 297087836160150, 68547485605788, 384933757171264, 40070368723392, 55732823199492, 127067975175478, 94488451201185, 268765383832110, 184167889698292, 96065281524621, 81387801907505, 222099166664455, 131539134671276, 231720538501535, 304012837725915, 532639885579088, 5873657053176, 177001561508064, 494673714512432, 198489464687563, 123597147166844, 150807957490070, 51461764967052, 47873078917500, 96213640830482, 31516330674752, 174184884351688, 159619433703024, 119362097063121, 172343544609588, 574096442374750, 1762656509620]
[184658593087404, 313121691862308, 141052384529834, 258373482063655, 220824312007368, 399215071871110, 236454749598912, 54819374375320, 258251644836990, 353334427214684, 74003170622864, 315782144924940, 211386248221806, 430563133856246, 56099384749362, 536832556559750, 281392977280364, 59081516564253, 600334313381565, 242511370135005, 565324716528904, 77905414385735, 5864617937335, 174627675443200, 220742058903648, 90169388887152, 255798501447104, 212552313842239, 182951799095936, 454530598277370, 330946969192587, 372795224996514, 240022567737456, 578484904402608, 519623706503724, 6336961836816, 101114639410290, 84165817318143, 570570592642500, 25470551225250]
[178103106769086, 360290549188908, 342548174266187, 370592262553255, 363056182421427, 46077463726580, 43638528314064, 351417885711270, 105742087716825, 128946759788743, 325156085126320, 454495697677620, 165955685880837, 231031483093821, 165158439043356, 486848542903250, 93701995477396, 197800208565060, 340105347235520, 217428415663600, 592270210285384, 193441411601940, 386320913003345, 203714316997072, 137703156859944, 219689479831920, 90253221547552, 173850854322131, 16384316087568, 342114770465485, 445641217127469, 114848598693432, 254909824571318, 12564155090144, 414508742989604, 192492243399600, 83448330456513, 128622286285251, 586174925131500, 50250054976600]
[387688032685692, 367456958564220, 237817950172760, 206920387900271, 155184539442408, 12805299517670, 64348366712832, 164791114189890, 551927980646805, 286533322582442, 576669250530912, 373047155773164, 265356294937773, 277688116348210, 190388943234459, 40027928731450, 446328067625356, 217426278127389, 289143894557085, 170022552320415, 43476539222372, 191162572116950, 22456378682880, 450127662641552, 285341021407698, 153408986813856, 372364102417552, 183410794488803, 85036194298900, 177832242165005, 429922249790715, 231422054759826, 2439156459985, 427108638500992, 98990818583404, 172290109268304, 88181481453054, 37305790434330, 651024058403875, 9440537510800]
[501749197539192, 571761186499764, 378211336334327, 360055633658834, 151075355467008, 99848751683780, 39860166670848, 239601777985145, 412311355151535, 51869112370487, 262915480243808, 544697022542868, 9467928092472, 81884800944517, 92544386956578, 529443017366670, 553625850012176, 68154126811017, 51503602781580, 389845756486200, 282995691425480, 81206137246495, 53356099608340, 317473717631280, 424780287221268, 67370410612560, 179027660064064, 142959630960167, 67190460746500, 308964019715450, 361583994354165, 169079836293396, 1604067393838, 66717282316384, 170732297271240, 212734371406128, 50455792137597, 124561362776334, 433490969559375, 46205026592550]
[433487257885926, 569653552987128, 217906006346378, 410277549251600, 108022414282890, 379043010445330, 20476266002448, 40224763920005, 208231824095400, 155083407138461, 106690832238592, 547337922109596, 72448310675076, 312424336964366, 166813388922027, 199573609866620, 462473731554632, 123888276728130, 590496114519995, 380198352577745, 434996258179300, 422990164904975, 411895537152490, 17858552544224, 517209163412322, 121610772897840, 490415943606960, 14883104270258, 225393140690900, 93649205837315, 443579758452963, 204010588299990, 192062773231700, 353042074504560, 38265430300588, 130718749541712, 62977297413228, 25856366067246, 70028411000500, 3852124284590]
[46395153911730, 44319570813036, 180645709024811, 293701148427998, 195092897498994, 221255820431690, 216859656516768, 98692546359560, 198616365882900, 334584985578286, 29138549541136, 440752405451760, 254584466805810, 501777995050173, 123387505262586, 209979275575300, 472826376867464, 205081829327811, 214190426422250, 359183755348845, 387521573619876, 246059070134105, 269178950787270, 70057279785248, 347340821324382, 92599973277024, 520013348530704, 483787306709, 182463584077632, 11381453801415, 526097851302573, 180189565056516, 121770977289990, 21471408593936, 524361592534976, 204310214496288, 65870169947637, 136679703051144, 115676919424625, 29116547791050]
[31523514098784, 296574375762612, 482266396674546, 8934825140965, 489788431999542, 327626006445320, 131547568773744, 3391655920365, 383551460620860, 344343483111095, 24563473245808, 47686349576880, 201187654995504, 391847429634336, 220632380357448, 68436483421460, 161006454615056, 200875576665972, 264072822382875, 39437285789025, 183818866555440, 161031996596510, 382529291582780, 303023819418656, 119941800554886, 103920842918496, 528349853563840, 254685691762670, 6983406084044, 463149829681745, 147626242256691, 170640687768024, 174392948235688, 158662001081024, 164404936063048, 108484887400944, 2683544610912, 121607910018837, 185765084516250, 42236491665060]
[406999358416494, 215175720365172, 117885855430437, 177063064113876, 310370937995007, 452041041195370, 130448273247984, 194366028336330, 244905680878845, 324929518853843, 590924943175280, 335126672864028, 108152132886651, 284158540398198, 124756265267097, 375905462398620, 179286885809380, 81843626095005, 8650271320725, 4822228557190, 591140174285172, 215672497506375, 19328469571420, 316792817157600, 432893674239564, 101387105927088, 207047380963472, 21866460279090, 141333565687808, 402273393822600, 303995114090712, 35600009381244, 32344181171764, 596217945298640, 93601260179788, 204895774636656, 148148701624935, 114335648737332, 614479649452375, 47274818608160]
[268674964727484, 358169334105816, 340142184597399, 337421321958229, 223286933867127, 349508576383890, 225745117477008, 278671537015200, 190631187235755, 110819200288536, 560125424309920, 329358350934756, 15563134908663, 131468805682877, 97622629299195, 552384668624690, 345913782280492, 269787275133444, 482126624897350, 252690894330940, 79247515787568, 255034231973415, 444686490300045, 147314342014560, 82964534205948, 237260265407280, 62217289123472, 247696580265582, 44042958869104, 397224022400155, 409053081148866, 462612192018180, 196373872293102, 318690536306464, 565015012231128, 225000056906784, 96368224668705, 137358724046775, 338494846802625, 22551402638570]

[*] Attacking Rands...
flag{n0_impl3m3nt3s_tU_pr0p14_cr1pt0!!}

```
## Flag
> **flag{n0_impl3m3nt3s_tU_pr0p14_cr1pt0!!}**
